# FFLSharp

![image](https://github.com/user-attachments/assets/40ea3cb7-ec55-465f-90a1-aa839bc1d299)

C# bindings for FFL, based on [my fork of Abood's decompilation](https://github.com/ariankordi/ffl).
FFL is the official library for rendering Mii heads and managing Mii data on Wii U.

In this repo, you will find:

* FFLSharp.VeldridRenderer, which includes routines and classes involved with drawing Mii heads using Veldrid which should work for all of its supported APIs.
* FFLSharp.Interop, which are the actual bindings to FFL itself. 
  - These are autogenerated by ClangSharp using the GenerateFFL.rsp recipe.
* FFLSharp.BasicTests - ignore this, they are so basic they don't even count.
* FFLSharp.FFLManager - Static class that includes helpers for initializing FFL and creating CharModels.
* FFLSharp.VeldridBasicShaderSample, pictured above. It renders a Mii head spinning, similar to [FFL-Testing](https://github.com/ariankordi/FFL-Testing), and it blinks every few seconds.
* (No sample using the FFLShader currently.)

I'm hoping that the Veldrid stuff would help if anyone wanted to use Miis in other graphics APIs/game engines, including anything using OpenGL which would be really simple
**especially if you use my FFL raylib samples to guide you: todo todo I reeeally have to publish these**

## Building
For brevity, I'm going to skip the C# portion since it should be easy enough to build - hit run in Visual Studio or `dotnet run` in a project folder. The real challenge is
* Building libffl.
* Acquiring the resource file.

For the moment, you will have to pull the FFL-Testing repo to use its CMakeLists (tested to work on branch renderer-server-prototype, commit blah. If you are following this months in the future and the current version doesn't work, please try that one)

#### libffl building

**TODO TODO NOT DONE!!!!!!!!!! NEEEEEEEEED TO MAKE CMAKE PROJECT!!! if you are lURKING you should hack [the FFL-Testing makefile](https://github.com/ariankordi/FFL-Testing/blob/renderer-server-prototype/Makefile) to build a library tho it neeeds latest rio changes too hh**

<details>
<summary>

## Questions/Answers
</summary>


### I donâ€™t like C#, why should I care?
Since this has an implementation of using FFL to draw Miis in a non-C/C++ language, and using a Vulkan-like API (Veldrid), it can be a base to open possibilities for bringing FFL to all sorts of places.
### Can I use this in Unity?
Not yet.

Itâ€™s totally possible to use everything in this repo to draw Miis in Unity as a managed plugin, and it should work on .NET Standard 2.0 (Unity 2020 and later).
However, I havenâ€™t made such a plugin yet. Nothing stopping you from doing it though!
### Can I use on ðŸ˜¹ Unity Wii U? ðŸ˜¹
Probably not.

The lowest I could get ClangSharp to generate bindings for is C# 7 and .NET Standard 2.0, both of which are far newer than the last major release of Unity Wii U (I think.)

â€¦However, it may be simpler to use FFL in Unity Wii U as a whole since they are both calling to the same GX2 API. Try Aboodâ€™s original version of the decomp.
#### On Switch?
Maybe! Itâ€™s worth a try. Youâ€™d have to get the build for libffl working on the NX target, which is cursed as all hell...
</details>

# Acknowledgements
* [aboood40091/AboodXD](https://github.com/aboood40091) for the [FFL decompilation and port to RIO](https://github.com/aboood40091/ffl/tree/nsmbu-win-port).
* [ClangSharp](https://github.com/dotnet/ClangSharp) for autogenerated bindings.
* [Eric Mellino](https://github.com/mellinoe) for [Veldrid](https://github.com/veldrid/veldrid).
* Nintendo for making FFL.
